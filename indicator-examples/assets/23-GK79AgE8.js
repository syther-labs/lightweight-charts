import{e as p,q as _,g as S,D as m,h as D}from"./sample-data-DY_WE15M.js";import{c as f}from"./weighted-close-calculation-BeWUi6qC.js";function b(s,e){class a{_baseSeries=null;_indicatorSeries=null;_chart=null;_options=null;attached(t){const{chart:r,series:h}=t;this._chart=r,this._baseSeries=h,this._indicatorSeries=this._chart.addSeries(p),this._options=e,h.subscribeDataChanged(this._updateData),this._updateData()}detached(){this._baseSeries&&this._baseSeries.unsubscribeDataChanged(this._updateData),this._indicatorSeries&&this._chart?.removeSeries(this._indicatorSeries),this._indicatorSeries=null}indicatorSeries(){if(!this._indicatorSeries)throw new Error("unable to provide indicator series");return this._indicatorSeries}applyOptions(t){this._options={...this._options||{},...t},this._updateData()}_updateData=()=>{if(!this._indicatorSeries)return;if(!this._baseSeries){this._indicatorSeries.setData([]);return}const t=this._baseSeries.data(),r=f(t,this._options||e);this._indicatorSeries.setData(r)}}const c=new a;return s.attachPrimitive(c),c}const g={autoSize:!0},l=_("chart",g),d=S(150,new Date(2024,0,1)),[w,v]=[d.slice(0,100),d.slice(100)],i=document.getElementById("weight");let n=2;i instanceof HTMLInputElement&&(n=Number.parseInt(i.value,10));const o=l.addSeries(m,{});o.setData(w);const u=b(o,{offset:2});u.indicatorSeries().applyOptions({color:"orange",lineWidth:2,lineStyle:D.Dotted});i instanceof HTMLInputElement&&i.addEventListener("input",()=>{n=Number.parseInt(i.value,10),u.applyOptions({weight:n})});l.timeScale().fitContent();setTimeout(async()=>{function s(e){return new Promise(a=>{setTimeout(a,e)})}for(const e of v)o.update(e),await s(200)},2e3);
